function f = fsuo(P1,P2,P3 )
dx0=1e-9;
e0=0;  T=25;            %%%%
dx=(1+e0)*dx0;
G11=dx^2*abs(4.124*(25-115)*1e5);


%F_bulk
a1=4.124*(T-115)*1e5;a11=-1.950*1e9;a12=7.974*1e8;a111=1.294*1e9;a112=-1.950*1e9;a123=-2.5*1e9;
a1111=3.860*1e10;a1112=2.529*1e10;a1122=1.637*1e10;a1123=1.367*1e10;
fbulk=a1*(P1.^2+P2.^2+P3.^2)+a11*(P1.^4+P2.^4+P3.^4)+a12*(P1.^2.*P2.^2+P3.^2.*P2.^2+P1.^2.*P3.^2)+a111*(P1.^6+P2.^6+P3.^6)+...
    a112*(P1.^2.*(P2.^4+P3.^4)+P2.^2.*(P1.^4+P3.^4)+P3.^2.*(P2.^4+P1.^4))+a123*P1.^2.*P2.^2.*P3.^2+...
    a1111*(P1.^8+P2.^8+P3.^8)+a1112*(P1.^6.*(P2.^2+P3.^2)+P2.^6.*(P1.^2+P3.^2)+P3.^6.*(P2.^2+P1.^2))+...
    a1122*(P1.^4.*P2.^4+P3.^4.*P2.^4+P1.^4.*P3.^4)+a1123*(P1.^4.*P2.^2.*P3.^2+P1.^2.*P2.^4.*P3.^2+P1.^2.*P2.^2.*P3.^4);
Fbulk=sum(sum(sum(fbulk*(dx)^3)));

%F_wall
p11=diff(P1,1,1)/dx;P11=cat(1,p11(1,:,:),p11);
p12=diff(P1,1,2)/dx;P12=cat(2,p12(:,1,:),p12);
p13=diff(P1,1,3)/dx;P13=cat(3,p13(:,:,1),p13);
p21=diff(P2,1,1)/dx;P21=cat(1,p21(1,:,:),p21);
p22=diff(P2,1,2)/dx;P22=cat(2,p22(:,1,:),p22);
p23=diff(P2,1,3)/dx;P23=cat(3,p23(:,:,1),p23);
p31=diff(P3,1,1)/dx;P31=cat(1,p31(1,:,:),p31);
p32=diff(P3,1,2)/dx;P32=cat(2,p32(:,1,:),p32);
p33=diff(P3,1,3)/dx;P33=cat(3,p33(:,:,1),p33);
fwall=0.5*G11*(P11.^2+P12.^2+P13.^2+P21.^2+P22.^2+P23.^2+P31.^2+P32.^2+P33.^2);
Fwall=sum(sum(sum(fwall*(dx)^3)));

%F_elec
p11=diff(P1,1,1)/dx;P11=cat(1,p11(1,:,:),p11);
p22=diff(P2,1,2)/dx;P22=cat(2,p22(:,1,:),p22);
p33=diff(P3,1,3)/dx;P33=cat(3,p33(:,:,1),p33);

yibu0=8.85*1e-12;
k11=190;k22=190;k33=190;
s=(P11+P22+P33)/yibu0;

fi=zeros(128,128,20);
fiold=fi+1;
finew=fi;
k=1;
while k<10000
    if max(max(max(abs(fi-fiold))))>=1e-4
        finew(2:127,2:127,2:19)=(k11*(fi(3:128,2:127,2:19)+fi(1:126,2:127,2:19))+...
            k22*(fi(2:127,3:128,2:19)+fi(2:127,1:126,2:19))+...
            k33*(fi(2:127,2:127,3:20)+fi(2:127,2:127,1:18))-dx^2*s(2:127,2:127,2:19))/2/(k11+k22+k33);
        fiold=fi;
        fi=finew;
    else
        k=10000;
    end
    k=k+1;
end

[E1,E2,E3]=gradient(fi);
E1=-E1;E2=-E2;E3=-E3;
felec=-0.5*(E1.*P1(:,:,1:20)+E2.*P2(:,:,1:20)+E3.*P3(:,:,1:20));%%%%
felec=cat(3,felec,zeros(128,128,16));

% F_elas
C11=1.78*10^11;
C12=0.964*10^11;
C44=1.22*10^11;
Q11=0.1;
Q12=-0.034;
Q44=0.029;



yibu11=e0;
yibu22=e0;
yibu33=-C12*2/C11*e0;%%这里三个正应变有约束条件
yibu12=0;yibu21=0;
yibu13=0;yibu31=0;
yibu23=0;yibu32=0;


felas1=0.5*C11*(yibu11.^2+yibu22.^2+yibu33.^2)+C12*(yibu11.*yibu22+yibu22.*yibu33+yibu11.*yibu33)+...
    2*C44*(yibu13.^2+yibu12.^2+yibu23.^2);
Felas1=sum(sum(sum(felas1*(dx)^3)));

beta11=0.5*C11*(Q11^2+2*Q12^2)+C12*Q12*(2*Q11+Q12);
beta12=C11*Q12*(2*Q11+Q12)+C12*(Q11^2+3*Q12^2+2*Q11*Q12)+C44*Q44^2;
felas2=beta11*(P1(:,:,1:32).^4+P2(:,:,1:32).^4+P3(:,:,1:32).^4)+beta12*(P1(:,:,1:32).^2.*P2(:,:,1:32).^2+P3(:,:,1:32).^2.*P2(:,:,1:32).^2+P1(:,:,1:32).^2.*P3(:,:,1:32).^2);
Felas2=sum(sum(sum(felas2*(dx)^3)));

q11=C11*Q11+2*C12*Q12;
q12=C11*Q12+C12*(Q11+Q12);
q44=2*C44*Q44;
felas3=-(q11*yibu11+q12*yibu22+q12*yibu33).*P1(:,:,1:32).^2-(q11*yibu22+q12*yibu11+q12*yibu33).*P2(:,:,1:32).^2-...
    (q11*yibu33+q12*yibu11+q12*yibu22).*P3(:,:,1:32).^2-2*q44*(yibu12.*P1(:,:,1:32).*P2(:,:,1:32)+yibu23.*P2(:,:,1:32).*P3(:,:,1:32)+yibu13.*P2(:,:,1:32).*P3(:,:,1:32));
Felas3=sum(sum(sum(felas3*(dx)^3)));

felas=felas1+felas2+felas3;
felas=cat(3,felas,zeros(128,128,4));
Felas=sum(sum(sum(felas*(dx)^3)));

f=fbulk+fwall+felec+felas;

end

